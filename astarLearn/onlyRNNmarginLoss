nohup: ignoring input
/home/wuning/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:34: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
-------------- Tensor("st_network/location_embedding/embedding_lookup:0", shape=(?, ?, 512), dtype=float32)
GRU state: Tensor("st_network/MultiRNNCellZeroState/MultiRNNCellZeroState/zeros:0", shape=(?, 512), dtype=float32)
states: Tensor("st_network/rnn/TensorArrayStack/TensorArrayGatherV3:0", shape=(?, ?, 512), dtype=float32)
Tensor("st_network/strided_slice_2:0", shape=(?, 512), dtype=float32)
2018-12-04 18:08:44.404195: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-12-04 18:08:44.404225: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-12-04 18:08:44.404230: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-12-04 18:08:44.404233: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-12-04 18:08:44.404237: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-12-04 18:08:47.134352: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: GeForce GTX 1080 Ti
major: 6 minor: 1 memoryClockRate (GHz) 1.645
pciBusID 0000:4e:00.0
Total memory: 10.91GiB
Free memory: 10.75GiB
2018-12-04 18:08:47.134386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 
2018-12-04 18:08:47.134392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y 
2018-12-04 18:08:47.134399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:4e:00.0)
generating new training data in epoch: 0
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
3200
3300
3400
3500
3600
3700
start training...
epoch:0... batch:0... satisfication[[-1.11927772e-02]
 [ 8.80949665e-03]
 [-4.99200448e-03]
 [ 2.45700404e-02]
 [-4.99200448e-03]
 [-6.92855846e-03]
 [-3.80574563e-03]
 [ 2.26121047e-04]
 [ 6.85877912e-03]
 [ 1.03198867e-02]
 [-4.99200448e-03]
 [ 3.99613148e-03]
 [ 2.03555245e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.70914878e-03]
 [ 3.46232369e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-3.31987930e-03]
 [-2.18422269e-03]
 [-4.99200448e-03]
 [-9.41310544e-04]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 1.79156121e-02]
 [-1.32965837e-02]
 [-4.99200448e-03]
 [ 1.74946003e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 8.90144380e-04]
 [-4.99200448e-03]
 [ 5.48038678e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-9.30525945e-04]
 [-9.66610573e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-8.06157757e-03]
 [-2.04620976e-03]
 [-1.24470433e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-5.54578193e-03]
 [-4.99200448e-03]
 [-4.39743465e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 1.82149448e-02]
 [-8.93989485e-03]
 [-2.58657779e-03]
 [ 3.62417996e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 2.54309783e-03]
 [-8.98952410e-03]
 [-9.58609380e-05]
 [ 3.98633210e-03]
 [ 1.31824976e-02]
 [-4.62985970e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 2.66585592e-02]
 [-4.99200448e-03]
 [-5.29425032e-03]
 [-2.29521352e-03]
 [-3.21650109e-03]
 [-4.99200448e-03]
 [-5.26598189e-03]
 [ 6.46003638e-04]
 [-3.45725031e-03]
 [ 7.02701928e-03]
 [-4.99200448e-03]
 [-4.96602943e-03]
 [-8.59408919e-03]
 [-7.38422992e-03]
 [ 5.40280947e-03]
 [-2.92371749e-03]
 [ 6.14853983e-04]
 [-2.18840456e-03]
 [-4.99200448e-03]
 [-3.38554638e-03]
 [-2.77609820e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-6.96350960e-03]
 [ 8.41704663e-03]
 [-5.55596594e-03]
 [ 2.98969895e-02]
 [-5.55596594e-03]
 [-6.42314740e-03]
 [-6.33918913e-03]
 [-1.80142629e-03]
 [ 2.16933875e-03]
 [ 9.85495932e-03]
 [-5.99651178e-03]
 [ 8.41436849e-04]
 [ 1.53007125e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.91577403e-03]
 [ 6.00654865e-04]
 [-5.55596594e-03]
 [-2.14350410e-03]
 [-4.50643571e-03]
 [-3.46407876e-03]
 [-5.55596594e-03]
 [-1.56381866e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 5.12103643e-03]
 [-5.55596594e-03]
 [ 1.36673609e-02]
 [-2.68214438e-02]
 [-5.55596594e-03]
 [ 1.68716237e-02]
 [-5.30061638e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 2.99542415e-04]
 [-5.55596594e-03]
 [ 2.10843422e-03]
 [-5.55596594e-03]
 [-4.27868403e-03]
 [ 2.73793377e-03]
 [-8.70722253e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-8.28151591e-03]
 [-5.94301382e-03]
 [-1.39116710e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-7.31410878e-03]
 [-5.55596594e-03]
 [-4.98089520e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-1.34631409e-03]
 [ 1.79307833e-02]
 [-9.43596661e-03]
 [-3.17523535e-03]
 [ 3.56481969e-02]
 [-1.47016498e-03]
 [-4.59827762e-03]
 [ 1.86621142e-03]
 [-8.46685190e-03]
 [-9.53684445e-04]
 [ 1.81051414e-03]
 [ 1.25934500e-02]
 [-4.40473109e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 2.60701869e-02]
 [-5.55596594e-03]
 [-5.91214839e-03]
 [-2.82392115e-03]
 [-4.31123096e-03]
 [-5.55596594e-03]
 [-5.67401852e-03]
 [-1.51800551e-03]
 [-2.14122026e-03]
 [ 2.13640439e-03]
 [-5.55596594e-03]
 [-5.18394168e-03]
 [-8.72078072e-03]
 [-8.31593852e-03]
 [ 2.64566694e-03]
 [ 6.63130311e-04]
 [-9.65215324e-04]
 [ 9.45963315e-04]
 [-5.55596594e-03]
 [-4.65752324e-03]
 [-4.91678249e-03]
 [-5.55596594e-03]
 [-5.67148486e-03]
 [-1.31615775e-03]
 [ 7.26152165e-03]
 [-5.98976575e-03]
 [ 2.52327379e-02]
 [-5.98976575e-03]
 [-6.36639772e-03]
 [-6.43725725e-05]
 [-3.54459556e-03]
 [-3.52866977e-04]
 [ 9.50986613e-03]
 [ 1.54494238e-03]
 [-1.28148869e-03]
 [ 2.54674684e-02]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-6.80344133e-03]
 [ 2.82449438e-03]
 [-5.98976575e-03]
 [-2.99255713e-03]
 [-3.72220320e-03]
 [-5.40724583e-03]
 [-5.98976575e-03]
 [-2.03727582e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-4.86562215e-03]
 [ 2.18663504e-03]
 [ 1.18578123e-02]
 [-1.60812289e-02]
 [-5.98976575e-03]
 [ 1.63957011e-02]
 [-7.58559909e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-1.54406560e-04]
 [-5.98976575e-03]
 [ 3.27578950e-04]
 [-5.98976575e-03]
 [ 1.99963618e-03]
 [ 9.96397575e-04]
 [-7.50144059e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-8.08695704e-03]
 [-2.56805215e-03]
 [-1.69176273e-02]
 [-5.98976575e-03]
 [-2.27705739e-03]
 [-8.44954420e-03]
 [-5.98976575e-03]
 [-5.57963923e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-6.50929287e-03]
 [-5.98976575e-03]
 [-2.34852917e-03]
 [ 1.62124895e-02]
 [-9.49962251e-03]
 [-3.63186444e-03]
 [ 3.51894498e-02]
 [-3.62874917e-03]
 [-3.60629708e-03]
 [-1.13089825e-03]
 [-1.21994847e-02]
 [-1.89921958e-03]
 [-1.61414297e-04]
 [ 1.21508418e-02]
 [-4.57786508e-02]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [ 2.56211944e-02]
 [-3.45338718e-03]
 [-6.39106333e-03]
 [-3.24217137e-03]
 [-5.04467776e-03]
 [-5.98976575e-03]
 [-6.14042673e-03]
 [-2.80724396e-03]
 [-3.76057811e-03]
 [-8.55620077e-04]
 [-5.98976575e-03]
 [-3.11095570e-03]
 [-8.89557879e-03]
 [-8.97298660e-03]
 [ 6.15260052e-03]
 [-1.90681266e-03]
 [ 3.99208954e-03]
 [ 3.89559864e-04]
 [-5.98976575e-03]
 [-2.86243577e-03]
 [-6.49125222e-03]
 [-5.98976575e-03]
 [-7.22435070e-03]
 [ 1.68063416e-04]
 [ 7.51746120e-03]
 [-6.32240577e-03]
 [ 2.94486210e-02]
 [-6.32240577e-03]
 [-6.30018674e-03]
 [-1.83632295e-03]
 [ 8.26238014e-04]
 [-2.10473989e-03]
 [ 9.25545394e-03]
 [-1.36446441e-03]
 [-2.79467576e-03]
 [ 2.32497845e-02]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-7.50280451e-03]
 [ 4.11366316e-04]
 [-6.32240577e-03]
 [-3.92908370e-03]
 [-4.86540375e-03]
 [-1.90735538e-03]
 [-6.32240577e-03]
 [-2.39749951e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [ 7.37971999e-03]
 [-6.45562759e-05]
 [ 1.05332732e-02]
 [-1.43517284e-02]
 [-6.32240577e-03]
 [ 1.17389252e-02]
 [-8.81473348e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-5.07825753e-04]
 [-6.32240577e-03]
 [-2.49880902e-03]
 [-6.32240577e-03]
 [ 2.59382580e-03]
 [ 4.37502936e-03]
 [-6.58713328e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-7.79531803e-03]
 [-5.53748477e-03]
 [-1.79428644e-02]
 [-6.32240577e-03]
 [ 2.05324078e-03]
 [-4.70064767e-03]
 [-6.32240577e-03]
 [-5.98995388e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.60845172e-03]
 [-6.32240577e-03]
 [-3.11252917e-03]
 [ 1.69342570e-02]
 [-1.32401288e-02]
 [-3.98725644e-03]
 [ 3.48237008e-02]
 [-4.63998457e-03]
 [-3.16503271e-03]
 [-3.23749875e-04]
 [-9.17086657e-03]
 [-2.87058088e-03]
 [-1.90045079e-03]
 [ 1.18189426e-02]
 [-4.48939987e-02]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [ 3.39567587e-02]
 [-3.95957381e-03]
 [-6.76383544e-03]
 [-3.57053219e-03]
 [-5.70323924e-03]
 [-6.32240577e-03]
 [-6.64619822e-03]
 [-3.67639819e-03]
 [-4.58539790e-03]
 [ 4.06599184e-03]
 [-4.35623433e-03]
 [ 4.74585360e-03]
 [-1.13900155e-02]
 [-9.26740840e-03]
 [ 9.68870055e-03]
 [ 3.51799978e-03]
 [ 2.13452568e-03]
 [-1.35331089e-03]
 [-6.32240577e-03]
 [-4.77614161e-03]
 [-7.26533448e-03]
 [-6.32240577e-03]
 [-8.06996785e-03]
 [ 8.78250040e-03]
 [ 7.68221309e-03]
 [-6.56709028e-03]
 [ 2.46174149e-02]
 [-6.56709028e-03]
 [-6.17719954e-03]
 [-3.54173849e-03]
 [-1.86210382e-03]
 [-3.57450312e-03]
 [ 9.06802714e-03]
 [-2.13940698e-03]
 [-3.86712747e-03]
 [ 2.05240566e-02]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [ 3.46595491e-03]
 [ 1.65146147e-03]
 [-6.56709028e-03]
 [-4.84970445e-03]
 [-5.78691252e-03]
 [-3.06105916e-03]
 [-6.56709028e-03]
 [-2.67364248e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [ 1.35779949e-02]
 [-2.12921532e-05]
 [ 9.56020411e-03]
 [-1.89830139e-02]
 [-6.56709028e-03]
 [ 1.20972963e-02]
 [-7.66313169e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.61817379e-03]
 [-6.56709028e-03]
 [-4.16509993e-03]
 [-6.56709028e-03]
 [ 7.39853736e-03]
 [ 2.38116877e-03]
 [-5.80036873e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-7.56007712e-03]
 [-3.71332775e-04]
 [-1.46511449e-02]
 [-2.10221671e-03]
 [ 1.76674977e-03]
 [-4.49627638e-03]
 [-6.56709028e-03]
 [-6.37897756e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.31501153e-03]
 [-6.56709028e-03]
 [-3.93311772e-03]
 [ 1.71083733e-02]
 [-1.34156672e-02]
 [-4.26367950e-03]
 [ 3.45405377e-02]
 [-5.03033958e-03]
 [-2.23310781e-03]
 [-1.33526349e-03]
 [-9.41147842e-03]
 [-3.73990252e-03]
 [-3.45095899e-03]
 [ 1.15664797e-02]
 [-4.35644798e-02]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [ 3.16746496e-02]
 [-4.42324439e-03]
 [-7.05536548e-03]
 [-3.83036816e-03]
 [-6.26267912e-03]
 [-6.56709028e-03]
 [-7.39448890e-03]
 [-4.32783039e-03]
 [-5.02566574e-03]
 [-6.31074188e-04]
 [-2.01114733e-03]
 [ 5.79808140e-04]
 [-1.22919893e-02]
 [-9.17907897e-03]
 [ 6.80237170e-03]
 [-1.52917975e-03]
 [ 3.78640034e-05]
 [-2.14844779e-03]
 [-6.56709028e-03]
 [-5.61612798e-03]
 [-7.61212828e-03]
 [-3.26047256e-03]
 [-8.39316566e-03]
 [ 8.50599352e-03]
 [ 7.78790051e-03]
 [-6.74836710e-03]
 [ 2.10929289e-02]
 [-6.74836710e-03]
 [-1.29523482e-02]
 [-4.78641130e-03]
 [-1.85766420e-03]
 [-4.57928190e-03]
 [ 8.93011317e-03]
 [-2.48190784e-03]
 [-4.50211810e-03]
 [ 1.86519567e-02]
 [-8.73706583e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 1.73700193e-03]
 [-2.15445715e-03]
 [-6.74836710e-03]
 [-5.48910908e-03]
 [-6.17564889e-03]
 [-2.77286023e-03]
 [-6.74836710e-03]
 [-2.89149978e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 1.08566890e-02]
 [ 5.49236778e-04]
 [ 8.71243048e-03]
 [-1.56609248e-02]
 [-1.07066706e-02]
 [ 1.29114473e-02]
 [-6.19288394e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 8.86764610e-04]
 [-6.74836710e-03]
 [-5.30765112e-03]
 [-8.39520246e-03]
 [ 7.08993711e-03]
 [ 5.32212015e-03]
 [-6.82408130e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-7.43178697e-03]
 [-4.27248096e-03]
 [-1.53445238e-02]
 [-7.01925528e-05]
 [ 1.07314387e-04]
 [-4.70462861e-03]
 [-6.74836710e-03]
 [-6.72493270e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-5.92770102e-03]
 [-6.74836710e-03]
 [-4.66005784e-03]
 [ 1.72443595e-02]
 [-1.03816697e-02]
 [ 2.06986512e-03]
 [ 3.63140330e-02]
 [-5.27584413e-03]
 [-1.04135985e-03]
 [-1.90140476e-04]
 [-8.04719143e-03]
 [-4.24265536e-03]
 [-4.38442593e-03]
 [ 1.13736251e-02]
 [-4.51938249e-02]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 3.68281677e-02]
 [-4.79052402e-03]
 [-7.28381239e-03]
 [-4.03870177e-03]
 [-6.69084117e-03]
 [-6.74836710e-03]
 [-7.03670038e-03]
 [-4.85158945e-03]
 [-5.38558932e-03]
 [-3.17877531e-03]
 [-1.60528417e-03]
 [-2.38453713e-03]
 [-1.11126127e-02]
 [-5.61509095e-03]
 [ 4.17426275e-03]
 [-2.03569350e-03]
 [ 5.31999953e-03]
 [ 1.79568069e-05]
 [-6.74836710e-03]
 [-7.94244837e-03]
 [-7.80023355e-03]
 [-9.55326669e-03]
 [-8.45379848e-03]
 [ 6.85961032e-03]
 [ 6.28677849e-03]
 [-6.88661681e-03]
 [ 1.94046963e-02]
 [-6.88661681e-03]
 [-1.12581523e-02]
 [-5.51664829e-03]
 [ 2.25497060e-03]
 [-5.49505418e-03]
 [ 8.82889051e-03]
 [-1.05934020e-03]
 [-4.96469624e-03]
 [ 1.75788440e-02]
 [ 1.45080383e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 1.16170151e-02]
 [ 3.50756478e-03]
 [-6.88661681e-03]
 [-6.10135309e-03]
 [-6.65392959e-03]
 [-1.00454967e-03]
 [-6.88661681e-03]
 [-3.06147872e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 8.21952429e-03]
 [ 9.48359739e-05]
 [ 8.06509051e-03]
 [-1.27634238e-02]
 [-9.33004729e-03]
 [ 1.37445210e-02]
 [-5.74518787e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.96681254e-03]
 [-6.88661681e-03]
 [-6.06564898e-03]
 [-2.20523891e-03]
 [ 4.95270733e-03]
 [ 3.23959021e-03]
 [-1.20214419e-02]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-7.32150581e-03]
 [-1.43058097e-03]
 [-1.42384889e-02]
 [-3.91863199e-04]
 [-1.79902953e-03]
 [-4.23196238e-03]
 [-6.88661681e-03]
 [-7.00764824e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-2.41301185e-03]
 [-5.80833992e-03]
 [-6.88661681e-03]
 [-6.77143317e-03]
 [ 1.82605088e-02]
 [-1.05220461e-02]
 [-7.87773402e-04]
 [ 4.51408178e-02]
 [-5.46428654e-03]
 [-8.23943876e-04]
 [ 7.44465180e-03]
 [-1.01578608e-02]
 [-4.65712696e-03]
 [-5.15964068e-03]
 [ 1.73557010e-02]
 [-4.49665487e-02]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 3.46761085e-02]
 [-5.08367177e-03]
 [-7.46384449e-03]
 [-4.20797616e-03]
 [-7.04352697e-03]
 [-6.88661681e-03]
 [-7.96978129e-04]
 [-5.18628815e-03]
 [-5.27041173e-03]
 [-4.14665882e-03]
 [ 1.17971725e-03]
 [-3.97593668e-03]
 [-7.35973194e-03]
 [ 2.21920386e-03]
 [ 2.55863671e-03]
 [-5.37553709e-03]
 [ 2.73014349e-03]
 [ 2.21383455e-03]
 [-6.88661681e-03]
 [-8.22793879e-03]
 [-7.93820061e-03]
 [-6.85969554e-03]
 [-8.50358699e-03]]... st_mean-0.0025857207365334034... neg_satisfication[[ 1.93174009e-03]
 [ 4.73944563e-03]
 [-4.99200448e-03]
 [ 2.45700404e-02]
 [-4.99200448e-03]
 [-1.96152739e-03]
 [-3.80574563e-03]
 [-2.81578489e-03]
 [ 1.62700901e-03]
 [ 1.03198867e-02]
 [-7.63138896e-03]
 [ 5.58434287e-04]
 [ 1.25810280e-02]
 [-6.11877767e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-2.06049951e-03]
 [-4.70914878e-03]
 [-1.25865289e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-3.31987930e-03]
 [-5.86962700e-03]
 [-4.99200448e-03]
 [-9.41310544e-04]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 1.43339960e-02]
 [-1.55399675e-02]
 [-4.99200448e-03]
 [ 1.74946003e-02]
 [-4.99200448e-03]
 [-7.84552936e-03]
 [-1.60877816e-02]
 [ 7.09483647e-05]
 [-4.99200448e-03]
 [-6.73639867e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 1.72261964e-03]
 [-1.57448072e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-8.06157757e-03]
 [-2.65651313e-03]
 [-1.24470433e-02]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.39743465e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [ 1.82149448e-02]
 [-8.93989485e-03]
 [-2.58657779e-03]
 [ 2.72217672e-02]
 [-4.62640868e-03]
 [-4.99200448e-03]
 [ 2.54309783e-03]
 [-6.15602033e-03]
 [-7.39950128e-03]
 [-5.08455560e-03]
 [ 1.31824976e-02]
 [-3.63702960e-02]
 [-4.99200448e-03]
 [-5.13681397e-03]
 [ 1.42254634e-02]
 [-4.99200448e-03]
 [-5.29425032e-03]
 [-7.12179020e-03]
 [ 5.86121809e-04]
 [-2.40518036e-03]
 [-5.26598189e-03]
 [ 6.46003638e-04]
 [-3.45725031e-03]
 [-4.96604200e-03]
 [-4.99200448e-03]
 [-4.96602943e-03]
 [-9.89836082e-03]
 [-5.41358395e-03]
 [ 6.16132398e-04]
 [-1.40237994e-03]
 [-9.30802990e-03]
 [-6.15365151e-03]
 [-4.99200448e-03]
 [-3.38554638e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-4.99200448e-03]
 [-9.51399188e-03]
 [ 1.01541663e-02]
 [-5.55596594e-03]
 [ 2.22609118e-02]
 [-5.55596594e-03]
 [-6.42314740e-03]
 [-5.44190127e-03]
 [-2.90053693e-04]
 [ 2.16933875e-03]
 [ 9.85495932e-03]
 [-5.55596594e-03]
 [ 8.41436849e-04]
 [ 1.95139572e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.09747118e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.91577403e-03]
 [ 6.00654865e-04]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-4.50643571e-03]
 [-3.46407876e-03]
 [-5.55596594e-03]
 [-1.56381866e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 1.54922539e-02]
 [-1.29038375e-02]
 [-1.10257100e-02]
 [ 1.69262085e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 8.49035941e-03]
 [-5.55596594e-03]
 [ 2.10843422e-03]
 [-1.44236684e-02]
 [-3.95334326e-03]
 [-2.22598156e-03]
 [-8.70722253e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-8.28151591e-03]
 [-5.94301382e-03]
 [-1.76330023e-02]
 [ 2.45901843e-04]
 [-4.38603805e-03]
 [-7.31410878e-03]
 [-5.55596594e-03]
 [-4.98089520e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-1.68413538e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 1.75776146e-02]
 [-9.43596661e-03]
 [-4.86221677e-03]
 [ 3.56481969e-02]
 [-5.55596594e-03]
 [-2.64993380e-03]
 [ 1.86621142e-03]
 [-8.46685190e-03]
 [-9.53684445e-04]
 [-2.12809100e-04]
 [ 1.25934500e-02]
 [-5.26412725e-02]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [ 2.60701869e-02]
 [-5.55596594e-03]
 [-5.91214839e-03]
 [-2.82392115e-03]
 [-2.32878141e-03]
 [-5.55596594e-03]
 [-5.67401852e-03]
 [-1.51800551e-03]
 [-3.37832351e-03]
 [ 6.97482796e-03]
 [-3.04724462e-03]
 [-5.18394168e-03]
 [-8.72078072e-03]
 [-1.19076567e-02]
 [ 2.64566694e-03]
 [-4.82325675e-03]
 [-9.65215324e-04]
 [-3.07135726e-03]
 [-1.14306295e-02]
 [-4.65752324e-03]
 [-4.91678249e-03]
 [-5.55596594e-03]
 [-5.55596594e-03]
 [-5.73400175e-03]
 [ 7.37039186e-03]
 [-5.98976575e-03]
 [ 2.76413504e-02]
 [-5.98976575e-03]
 [-1.13060037e-02]
 [-7.64314877e-03]
 [-3.54459556e-03]
 [-3.52866977e-04]
 [ 9.50986613e-03]
 [-5.85510489e-03]
 [-1.28148869e-03]
 [ 1.34512642e-02]
 [-5.98976575e-03]
 [-9.91061889e-03]
 [-5.98976575e-03]
 [-1.95402396e-03]
 [-5.98976575e-03]
 [-6.80344133e-03]
 [-1.36940018e-03]
 [-5.36119845e-03]
 [-2.99255713e-03]
 [-5.30037936e-03]
 [-4.30428889e-03]
 [-5.98976575e-03]
 [-2.03727582e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-6.39499445e-03]
 [-5.98976575e-03]
 [ 1.39054321e-02]
 [-3.20454240e-02]
 [-5.98976575e-03]
 [ 1.46064274e-02]
 [-7.58559909e-03]
 [-8.96871649e-03]
 [-2.68919696e-03]
 [-1.54406560e-04]
 [-9.50348750e-03]
 [-4.88349120e-04]
 [-2.02599959e-03]
 [-2.42876727e-03]
 [ 9.96397575e-04]
 [-8.25153757e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-8.08695704e-03]
 [-7.97667447e-03]
 [-2.02511679e-02]
 [-5.98976575e-03]
 [-4.83675022e-03]
 [-4.09849361e-03]
 [-5.98976575e-03]
 [-5.57963923e-03]
 [-5.98976575e-03]
 [-9.27973818e-03]
 [-7.06137205e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-5.98976575e-03]
 [-2.34852917e-03]
 [ 1.62124895e-02]
 [-1.87763516e-02]
 [-3.63186444e-03]
 [ 3.51894498e-02]
 [-3.62874917e-03]
 [-4.28599957e-03]
 [ 1.01498440e-02]
 [-9.70942155e-03]
 [-1.89921958e-03]
 [-1.61414297e-04]
 [ 1.21508418e-02]
 [-4.68171351e-02]
 [-1.27992127e-02]
 [-5.98976575e-03]
 [ 2.56211944e-02]
 [-5.98976575e-03]
 [-6.39106333e-03]
 [-3.24217137e-03]
 [-5.04467776e-03]
 [-5.98976575e-03]
 [-6.14042673e-03]
 [-2.80724396e-03]
 [-4.59897751e-03]
 [ 1.34529150e-03]
 [-7.77273159e-03]
 [-6.23241346e-03]
 [-1.09846666e-02]
 [-8.44628643e-03]
 [ 8.85308546e-04]
 [-1.90681266e-03]
 [-2.30858615e-03]
 [ 6.06193999e-03]
 [-5.98976575e-03]
 [-7.22281076e-03]
 [-6.49125222e-03]
 [-5.98976575e-03]
 [-7.22435070e-03]
 [ 3.71951173e-04]
 [ 5.77606726e-03]
 [-6.32240577e-03]
 [ 2.18619481e-02]
 [-6.32240577e-03]
 [-1.28394393e-02]
 [-6.42433530e-03]
 [-4.84343758e-03]
 [-2.10473989e-03]
 [ 9.25545394e-03]
 [-3.69968853e-04]
 [-2.79467576e-03]
 [ 2.35094801e-02]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-5.69430599e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-7.50280451e-03]
 [ 4.11366316e-04]
 [-6.32240577e-03]
 [-3.92908370e-03]
 [-4.86540375e-03]
 [-6.89596683e-03]
 [-6.32240577e-03]
 [-4.38585877e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-3.73986876e-03]
 [ 2.35999119e-03]
 [ 1.05332732e-02]
 [-8.86102114e-03]
 [-4.41443315e-03]
 [ 1.60287376e-02]
 [-8.81473348e-03]
 [-9.69882589e-03]
 [-6.32240577e-03]
 [-5.07825753e-04]
 [-6.32240577e-03]
 [-2.49880902e-03]
 [-6.32240577e-03]
 [ 5.22204617e-04]
 [-4.50808584e-04]
 [-6.58713328e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-7.79531803e-03]
 [-9.56932828e-03]
 [-1.79428644e-02]
 [-5.26830507e-03]
 [-1.77518092e-03]
 [-9.67756193e-03]
 [-6.32240577e-03]
 [-5.98995388e-03]
 [-6.32240577e-03]
 [-1.42173851e-02]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [-6.60845172e-03]
 [-6.32240577e-03]
 [-3.11252917e-03]
 [ 1.50919314e-02]
 [-9.21342988e-03]
 [-3.87675664e-03]
 [ 3.39480005e-02]
 [-6.93778740e-03]
 [-3.16503271e-03]
 [-1.86096248e-03]
 [-1.13490522e-02]
 [-2.87058088e-03]
 [-1.90045079e-03]
 [ 1.18189426e-02]
 [-5.40025793e-02]
 [-6.32240577e-03]
 [-6.32240577e-03]
 [ 2.52782479e-02]
 [-3.95957381e-03]
 [-6.76383544e-03]
 [-3.57053219e-03]
 [-2.66592996e-03]
 [-6.87943120e-03]
 [-9.16512776e-03]
 [-3.67639819e-03]
 [-8.17898568e-03]
 [-2.60219327e-03]
 [-6.32240577e-03]
 [-3.30638187e-03]
 [-7.76299834e-03]
 [-9.26740840e-03]
 [ 6.99207280e-03]
 [-2.90899188e-03]
 [ 2.13452568e-03]
 [ 6.80815428e-03]
 [-6.32240577e-03]
 [-4.77614161e-03]
 [-1.05845453e-02]
 [-6.32240577e-03]
 [-8.06996785e-03]
 [-3.59126343e-03]
 [-4.33411170e-03]
 [-6.56709028e-03]
 [ 1.14026619e-02]
 [-6.56709028e-03]
 [-4.91347304e-03]
 [-3.54173849e-03]
 [-1.04556456e-02]
 [-3.57450312e-03]
 [ 9.06802714e-03]
 [-2.13940698e-03]
 [-3.86712747e-03]
 [ 2.61382479e-02]
 [-5.69851138e-03]
 [-1.21528311e-02]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-7.96466600e-03]
 [ 1.21988798e-03]
 [-6.56709028e-03]
 [-4.84970445e-03]
 [-5.78691252e-03]
 [-2.22165720e-03]
 [-1.28626460e-02]
 [-2.67364248e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [ 3.41036776e-03]
 [ 4.64765180e-04]
 [ 9.56020411e-03]
 [-1.28509095e-02]
 [-4.69646230e-03]
 [ 1.20972963e-02]
 [-9.18127969e-03]
 [-9.64264106e-03]
 [-6.56709028e-03]
 [-7.82922609e-04]
 [-6.56709028e-03]
 [-4.60136449e-03]
 [-6.56709028e-03]
 [ 1.27180410e-03]
 [ 2.38116877e-03]
 [-5.80036873e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-7.56007712e-03]
 [-9.22618434e-03]
 [-1.52229602e-02]
 [-1.30195334e-03]
 [ 5.03561599e-03]
 [-4.49627638e-03]
 [-3.88156762e-03]
 [-6.37897756e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [-6.97217928e-03]
 [-6.56709028e-03]
 [-3.93311772e-03]
 [ 1.71083733e-02]
 [-1.34156672e-02]
 [-4.26367950e-03]
 [ 3.45405377e-02]
 [-5.03033958e-03]
 [-3.35591729e-03]
 [-1.33526349e-03]
 [-9.41147842e-03]
 [-3.73990252e-03]
 [-4.83130664e-03]
 [ 1.15664797e-02]
 [-5.35284355e-02]
 [-6.56709028e-03]
 [-6.56709028e-03]
 [ 3.16746496e-02]
 [-4.42324439e-03]
 [-1.51542565e-02]
 [-3.83036816e-03]
 [-6.26267912e-03]
 [-6.56709028e-03]
 [-7.11188419e-03]
 [-4.32783039e-03]
 [-5.02566574e-03]
 [ 9.20250360e-03]
 [-5.47113689e-03]
 [-1.09871780e-03]
 [-1.49136754e-02]
 [-7.22716097e-03]
 [ 2.30082055e-03]
 [-1.04415296e-02]
 [ 3.78640034e-05]
 [-4.75950167e-03]
 [-6.56709028e-03]
 [-5.61612798e-03]
 [-7.61212828e-03]
 [-4.78733052e-03]
 [-8.76491982e-03]
 [ 3.51982727e-03]
 [ 7.78790051e-03]
 [-6.74836710e-03]
 [ 2.10929289e-02]
 [-6.74836710e-03]
 [-6.16939319e-03]
 [-4.11186274e-03]
 [-3.85446870e-03]
 [-4.57928190e-03]
 [ 8.93011317e-03]
 [-8.47912114e-03]
 [-1.03990790e-02]
 [ 1.86519567e-02]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 1.73700193e-03]
 [-4.31886205e-04]
 [-6.74836710e-03]
 [-5.48910908e-03]
 [-6.17564889e-03]
 [-2.77286023e-03]
 [-6.74836710e-03]
 [-2.89149978e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 9.02479887e-03]
 [ 5.49236778e-04]
 [ 8.71243048e-03]
 [-1.56609248e-02]
 [-6.74836710e-03]
 [ 1.29114473e-02]
 [-6.19288394e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 2.86159781e-03]
 [-6.74836710e-03]
 [-5.30765112e-03]
 [-6.74836710e-03]
 [-1.45433267e-04]
 [ 8.19303794e-04]
 [-5.37388911e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-7.43178697e-03]
 [-4.27248096e-03]
 [-1.65498704e-02]
 [-3.86283174e-03]
 [ 1.20298704e-03]
 [-4.70462861e-03]
 [-6.74836710e-03]
 [-8.41323566e-03]
 [-6.74836710e-03]
 [-6.44594431e-03]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [-6.34493446e-03]
 [-5.92770102e-03]
 [-1.58190522e-02]
 [-1.13023203e-02]
 [ 1.70319490e-02]
 [-1.28686531e-02]
 [-4.47885040e-03]
 [ 3.43225859e-02]
 [-7.07641756e-03]
 [-1.04135985e-03]
 [-1.49693131e-03]
 [-9.48595349e-03]
 [-4.24265536e-03]
 [-4.38442593e-03]
 [ 1.13736251e-02]
 [-5.24753816e-02]
 [-6.74836710e-03]
 [-6.74836710e-03]
 [ 2.96253208e-02]
 [-4.79052402e-03]
 [-7.28381239e-03]
 [-4.03870177e-03]
 [-6.69084117e-03]
 [-6.74836710e-03]
 [-7.03670038e-03]
 [-4.85158945e-03]
 [-5.38558932e-03]
 [-3.17877531e-03]
 [-4.69122175e-03]
 [-2.38453713e-03]
 [-1.11126127e-02]
 [-8.35734233e-03]
 [ 4.17426275e-03]
 [-5.75302867e-03]
 [-1.47522078e-03]
 [-2.96976161e-03]
 [-6.74836710e-03]
 [-1.96852721e-03]
 [-7.80023355e-03]
 [-4.84486483e-03]
 [-1.05572818e-02]
 [ 4.40757023e-03]
 [ 2.94940663e-03]
 [-6.88661681e-03]
 [ 1.94046963e-02]
 [-1.31536694e-02]
 [-1.12581523e-02]
 [-8.22617207e-03]
 [-4.54970775e-03]
 [-1.66599620e-02]
 [ 8.82889051e-03]
 [-1.03289792e-02]
 [-4.96469624e-03]
 [ 1.75788440e-02]
 [-8.16270430e-03]
 [-6.88661681e-03]
 [-6.23531220e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-2.65228242e-04]
 [-2.50674994e-03]
 [-1.25460001e-02]
 [-6.10135309e-03]
 [-8.16086587e-03]
 [-2.68465118e-03]
 [-6.88661681e-03]
 [-3.06147872e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 8.21952429e-03]
 [-7.24947779e-04]
 [ 8.06509051e-03]
 [-1.72201879e-02]
 [-1.76348686e-02]
 [ 1.37445210e-02]
 [-5.74518787e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 8.12979648e-04]
 [-6.88661681e-03]
 [-8.29723105e-03]
 [-8.03464744e-03]
 [ 1.11369845e-02]
 [ 3.23959021e-03]
 [-6.64512021e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 3.05992755e-04]
 [-6.45436253e-03]
 [-1.12880496e-02]
 [ 1.83289498e-03]
 [-1.79902953e-03]
 [-7.28196464e-03]
 [-7.34221563e-03]
 [-7.00764824e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [-5.80833992e-03]
 [-6.88661681e-03]
 [-5.37000084e-03]
 [ 1.82605088e-02]
 [-1.34119010e-02]
 [-7.87773402e-04]
 [ 3.63708884e-02]
 [-1.54800224e-03]
 [-3.43139656e-03]
 [-7.80354021e-04]
 [-1.01578608e-02]
 [-4.65712696e-03]
 [-5.15964068e-03]
 [ 9.40407347e-03]
 [-4.87943701e-02]
 [-6.88661681e-03]
 [-6.88661681e-03]
 [ 3.46761085e-02]
 [-7.24291056e-03]
 [-7.46384449e-03]
 [-4.20797616e-03]
 [-7.04352697e-03]
 [-6.88661681e-03]
 [-7.12285656e-03]
 [-5.41646918e-03]
 [-8.72274116e-03]
 [-4.14665882e-03]
 [-6.38809893e-03]
 [-3.97593668e-03]
 [-9.47571173e-03]
 [-9.46852099e-03]
 [-6.15166035e-03]
 [-5.37553709e-03]
 [ 2.73014349e-03]
 [-1.26020249e-03]
 [-6.88661681e-03]
 [-8.22793879e-03]
 [-7.93820061e-03]
 [-9.10541881e-03]
 [-8.50358699e-03]]... neg_mean-0.003574798349291086... loss:0.9990...
epoch:0... batch:2001... satisfication[[ 0.13040504]
 [ 0.40634713]
 [ 0.13040504]
 ...
 [-2.2157638 ]
 [-0.39044535]
 [ 0.05042591]]... st_mean-0.09819679707288742... neg_satisfication[[-0.860736  ]
 [ 0.40634713]
 [ 0.13040504]
 ...
 [-2.2157638 ]
 [-1.4588997 ]
 [ 0.05042591]]... neg_mean-0.24529007077217102... loss:0.8898...
Traceback (most recent call last):
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1327, in _do_call
    return fn(*args)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1306, in _run_fn
    status, run_metadata)
  File "/home/wuning/anaconda3/lib/python3.6/contextlib.py", line 88, in __exit__
    next(self.gen)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.UnimplementedError: TensorArray has size zero, but element shape [?,512] is not fully defined. Currently only static shapes are supported when packing zero-size TensorArrays.
	 [[Node: st_network/TensorArrayStack/TensorArrayGatherV3 = TensorArrayGatherV3[_class=["loc:@st_network/TensorArray"], dtype=DT_FLOAT, element_shape=[?,512], _device="/job:localhost/replica:0/task:0/gpu:0"](st_network/TensorArray, st_network/TensorArrayStack/range, st_network/while/Exit_2)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train.py", line 371, in <module>
    main()
  File "train.py", line 350, in main
    margin_loss_st_train(AstarRNN)
  File "train.py", line 271, in margin_loss_st_train
    model.st_optimizer.run(feed_dict=st_feed_data)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1744, in run
    _run_using_default_session(self, feed_dict, self.graph, session)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 4120, in _run_using_default_session
    session.run(operation, feed_dict)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 895, in run
    run_metadata_ptr)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1124, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1321, in _do_run
    options, run_metadata)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1340, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.UnimplementedError: TensorArray has size zero, but element shape [?,512] is not fully defined. Currently only static shapes are supported when packing zero-size TensorArrays.
	 [[Node: st_network/TensorArrayStack/TensorArrayGatherV3 = TensorArrayGatherV3[_class=["loc:@st_network/TensorArray"], dtype=DT_FLOAT, element_shape=[?,512], _device="/job:localhost/replica:0/task:0/gpu:0"](st_network/TensorArray, st_network/TensorArrayStack/range, st_network/while/Exit_2)]]

Caused by op 'st_network/TensorArrayStack/TensorArrayGatherV3', defined at:
  File "train.py", line 371, in <module>
    main()
  File "train.py", line 349, in main
    AstarRNN = DAN()
  File "/home/wuning/AstarRNN/learnAstar/model.py", line 52, in __init__
    self.create_step_by_step_st_network()
  File "/home/wuning/AstarRNN/learnAstar/model.py", line 121, in create_step_by_step_st_network
    self.nest_neg_outputs = tf.reshape(tf.add(self.st_destination_embedding, out.stack()), [-1, lstm_size])
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/tensor_array_ops.py", line 334, in stack
    return self.gather(math_ops.range(0, self.size()), name=name)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/tensor_array_ops.py", line 360, in gather
    element_shape=element_shape)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/ops/gen_data_flow_ops.py", line 2401, in _tensor_array_gather_v3
    element_shape=element_shape, name=name)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 767, in apply_op
    op_def=op_def)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2630, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "/home/wuning/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1204, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

UnimplementedError (see above for traceback): TensorArray has size zero, but element shape [?,512] is not fully defined. Currently only static shapes are supported when packing zero-size TensorArrays.
	 [[Node: st_network/TensorArrayStack/TensorArrayGatherV3 = TensorArrayGatherV3[_class=["loc:@st_network/TensorArray"], dtype=DT_FLOAT, element_shape=[?,512], _device="/job:localhost/replica:0/task:0/gpu:0"](st_network/TensorArray, st_network/TensorArrayStack/range, st_network/while/Exit_2)]]

